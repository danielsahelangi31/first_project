@layout('layout/index')

@section('content')
<div class="content flex-row-fluid" id="kt_content">

  <div class="card mt-5 mb-xl-10 bg-white">
    <div id="kt_account_settings_signin_method" class="collapse show">
        <div class="card-body border-top p-9">
            <div class="d-flex flex-lg-column ">  
              <div class="d-flex align-items-center  ">                    
                <svg class="mx-3" width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="19" cy="19" r="19" fill="#045299"/>
                  <path d="M19.6195 17.1307C19.1525 17.0845 18.6827 17.1839 18.2743 17.4151C17.866 17.6463 17.5391 17.9981 17.3384 18.4223C17.1377 18.8464 17.0731 19.3223 17.1532 19.7846C17.2334 20.247 17.4546 20.6733 17.7864 21.0051C18.1182 21.3369 18.5445 21.558 19.0068 21.6382C19.4692 21.7184 19.945 21.6538 20.3692 21.4531C20.7934 21.2524 21.1452 20.9255 21.3764 20.5171C21.6076 20.1088 21.7069 19.639 21.6608 19.172C21.6082 18.6485 21.3763 18.1593 21.0043 17.7872C20.6322 17.4152 20.143 17.1832 19.6195 17.1307V17.1307ZM25.0998 19.3957C25.0983 19.6431 25.0802 19.8901 25.0454 20.135L26.6532 21.3961C26.7232 21.4541 26.7704 21.5351 26.7863 21.6246C26.8023 21.7142 26.786 21.8064 26.7403 21.8851L25.2193 24.5168C25.1731 24.5947 25.1009 24.6537 25.0154 24.6836C24.9299 24.7135 24.8366 24.7122 24.752 24.68L23.1552 24.037C23.0671 24.002 22.9718 23.9893 22.8776 24.0002C22.7834 24.011 22.6935 24.0451 22.6157 24.0993C22.372 24.2671 22.1159 24.4161 21.8497 24.5452C21.766 24.5859 21.6936 24.6466 21.6389 24.7219C21.5841 24.7972 21.5488 24.8848 21.536 24.977L21.2967 26.6801C21.2809 26.77 21.2345 26.8517 21.1652 26.9112C21.0959 26.9707 21.0081 27.0043 20.9168 27.0062H17.8748C17.785 27.0046 17.6984 26.9725 17.6293 26.9152C17.5602 26.8579 17.5127 26.7787 17.4946 26.6907L17.2556 24.9901C17.2422 24.8969 17.206 24.8085 17.1501 24.7327C17.0943 24.6568 17.0206 24.596 16.9356 24.5555C16.6696 24.4272 16.4144 24.2777 16.1724 24.1085C16.0949 24.0546 16.0052 24.0208 15.9114 24.0102C15.8176 23.9996 15.7226 24.0124 15.635 24.0477L14.0386 24.6903C13.954 24.7225 13.8607 24.7239 13.7752 24.6941C13.6898 24.6643 13.6175 24.6053 13.5713 24.5274L12.0502 21.8958C12.0045 21.8171 11.9882 21.7248 12.0041 21.6353C12.0201 21.5457 12.0673 21.4648 12.1374 21.4068L13.4962 20.3399C13.5707 20.2808 13.6292 20.204 13.6665 20.1166C13.7037 20.0291 13.7186 19.9338 13.7096 19.8391C13.6968 19.6908 13.689 19.5429 13.689 19.3946C13.689 19.2463 13.6965 19.1005 13.7096 18.9554C13.7176 18.8613 13.702 18.7668 13.6643 18.6802C13.6266 18.5937 13.568 18.5179 13.4937 18.4596L12.1356 17.3928C12.0667 17.3345 12.0204 17.2538 12.005 17.1648C11.9896 17.0759 12.006 16.9843 12.0513 16.9062L13.5723 14.2746C13.6185 14.1967 13.6907 14.1376 13.7762 14.1077C13.8617 14.0779 13.955 14.0792 14.0396 14.1113L15.6364 14.7543C15.7245 14.7894 15.8199 14.8021 15.914 14.7912C16.0082 14.7803 16.0982 14.7463 16.1759 14.6921C16.4196 14.5243 16.6757 14.3752 16.942 14.2461C17.0257 14.2054 17.0981 14.1448 17.1528 14.0695C17.2075 13.9942 17.2428 13.9066 17.2556 13.8144L17.495 12.1113C17.5107 12.0213 17.5571 11.9396 17.6264 11.8801C17.6957 11.8207 17.7835 11.7871 17.8748 11.7852H20.9168C21.0066 11.7867 21.0932 11.8188 21.1623 11.8761C21.2314 11.9335 21.2789 12.0126 21.297 12.1006L21.536 13.8012C21.5494 13.8944 21.5857 13.9829 21.6415 14.0587C21.6973 14.1345 21.771 14.1953 21.8561 14.2358C22.122 14.3642 22.3772 14.5137 22.6193 14.6828C22.6967 14.7368 22.7864 14.7705 22.8802 14.7812C22.9741 14.7918 23.069 14.7789 23.1566 14.7437L24.753 14.101C24.8376 14.0688 24.9309 14.0675 25.0164 14.0973C25.1019 14.1271 25.1741 14.1861 25.2203 14.2639L26.7414 16.8956C26.7871 16.9742 26.8035 17.0665 26.7875 17.1561C26.7715 17.2456 26.7243 17.3266 26.6542 17.3846L25.2954 18.4515C25.2206 18.5104 25.1618 18.587 25.1242 18.6745C25.0866 18.7619 25.0715 18.8574 25.0802 18.9522C25.092 19.0994 25.0998 19.2474 25.0998 19.3957Z" stroke="white" stroke-width="1.13802" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>                
                  <h2 class="mx-3">Schema Approval</h2>     
                </div>                                          
            </div>
        </div>
    </div>
  </div>
  <!--begin::Navbar-->
  {{--  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>  --}}
  @include('pages/schema/dashboard')

  <div class="card mb-5 mb-xl-10 bg-white">
    <div id="kt_account_settings_signin_method" class="collapse show">      
      <div class="card-body border-top p-9">
        <div class="row my-5 ">
          <div class="col-lg-4">
              <div class="form-group">
                  <div class="input-icon">
                  <input id="search" type="text" class="form-control" placeholder="Search..."/>
                </div>
                <span><i class="flaticon2-search-1 icon-md"></i></span>
              </div>
          </div>
        </div>
        <div class="card-title m-0">
          <div class="btn" style="float: right;">
            <a href="{{route('schema.create')}}" class="btn btn-primary">
              <i class="fa fa-plus"></i> Add
            </a>
          </div>        
          @if(flashMessages.get('success'))
          <script>
            
          </script>                    
          @endif
          
        </div>
        <div class="kt-portlet__body kt-portlet__body--fit">

          <!--begin: Datatable -->
          <div class="my_datatable" id="kt_datatable">
            <table style="border-top-left-radius: 10px; border-top-right-radius: 10px; background-color: #B6EAFF;" id="example" class="table table-striped table-row-bordered gy-5 gs-7 border border-gray-300 display" id="example" class="table table-striped table-row-bordered gy-5 gs-7 border border-gray-300 display">
              <thead class="fw-semibold fs-6 text-gray-800">
                <tr>
                    <th></th>
                  <th>Schema Name</th>
                  <th>Master Data</th>
                  <th>Submiter</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody style="background-color: white">
                @each(schema in schema)
                <tr>
                    <td></td>
                  <td>{{schema.schema_name}}</td>
                  <td>{{schema.masterType.master_name}}</td>
                  <td>{{schema.role?.name}}</td>
                  <td>
                    <div class="btn-group" role="group" aria-label="Third group">
                      <a href="{{route('schema.edit',{id : schema.id})}}" type="button" class="mx-3">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <g clip-path="url(#clip0_96_1138)">
                          <path d="M22.58 5.54697L18.6667 1.61364C18.4081 1.35635 18.0582 1.21191 17.6934 1.21191C17.3286 1.21191 16.9786 1.35635 16.72 1.61364L2.8467 15.467L1.58004 20.9336C1.53634 21.1335 1.53784 21.3406 1.58442 21.5397C1.631 21.7389 1.72149 21.9252 1.84928 22.0849C1.97707 22.2446 2.13892 22.3738 2.32302 22.463C2.50712 22.5522 2.70882 22.5991 2.91337 22.6003C3.00868 22.6099 3.10472 22.6099 3.20004 22.6003L8.72671 21.3336L22.58 7.49364C22.8373 7.23504 22.9818 6.88509 22.9818 6.52031C22.9818 6.15552 22.8373 5.80557 22.58 5.54697V5.54697ZM8.06004 20.1336L2.88004 21.2203L4.06004 16.1403L14.44 5.80031L18.44 9.80031L8.06004 20.1336ZM19.3334 8.83364L15.3334 4.83364L17.6534 2.52697L21.5867 6.52697L19.3334 8.83364Z" fill="#C0C0C0"/>
                          </g>
                          <defs>
                          <clipPath id="clip0_96_1138">
                          <rect width="24" height="24" fill="white"/>
                          </clipPath>
                          </defs>
                        </svg>
                        </a>
                    </div>
                    <div class="btn-group" role="group" aria-label="Third group"> 
                      {{--  <a href="{{route('deleteSchema',{id : schema.id})}}"                --}}
                    <a  type="button"  class="mx-3 show_confirm" data-id="{{ schema.id }}" >
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 5H14C14 4.46957 13.7893 3.96086 13.4142 3.58579C13.0391 3.21071 12.5304 3 12 3C11.4696 3 10.9609 3.21071 10.5858 3.58579C10.2107 3.96086 10 4.46957 10 5ZM8.5 5C8.5 4.54037 8.59053 4.08525 8.76642 3.66061C8.94231 3.23597 9.20012 2.85013 9.52513 2.52513C9.85013 2.20012 10.236 1.94231 10.6606 1.76642C11.0852 1.59053 11.5404 1.5 12 1.5C12.4596 1.5 12.9148 1.59053 13.3394 1.76642C13.764 1.94231 14.1499 2.20012 14.4749 2.52513C14.7999 2.85013 15.0577 3.23597 15.2336 3.66061C15.4095 4.08525 15.5 4.54037 15.5 5H21.25C21.4489 5 21.6397 5.07902 21.7803 5.21967C21.921 5.36032 22 5.55109 22 5.75C22 5.94891 21.921 6.13968 21.7803 6.28033C21.6397 6.42098 21.4489 6.5 21.25 6.5H19.93L18.76 18.611C18.6702 19.539 18.238 20.4002 17.5477 21.0268C16.8573 21.6534 15.9583 22.0004 15.026 22H8.974C8.04186 22.0001 7.1431 21.653 6.45295 21.0265C5.7628 20.3999 5.33073 19.5388 5.241 18.611L4.07 6.5H2.75C2.55109 6.5 2.36032 6.42098 2.21967 6.28033C2.07902 6.13968 2 5.94891 2 5.75C2 5.55109 2.07902 5.36032 2.21967 5.21967C2.36032 5.07902 2.55109 5 2.75 5H8.5ZM10.5 9.75C10.5 9.55109 10.421 9.36032 10.2803 9.21967C10.1397 9.07902 9.94891 9 9.75 9C9.55109 9 9.36032 9.07902 9.21967 9.21967C9.07902 9.36032 9 9.55109 9 9.75V17.25C9 17.4489 9.07902 17.6397 9.21967 17.7803C9.36032 17.921 9.55109 18 9.75 18C9.94891 18 10.1397 17.921 10.2803 17.7803C10.421 17.6397 10.5 17.4489 10.5 17.25V9.75ZM14.25 9C14.4489 9 14.6397 9.07902 14.7803 9.21967C14.921 9.36032 15 9.55109 15 9.75V17.25C15 17.4489 14.921 17.6397 14.7803 17.7803C14.6397 17.921 14.4489 18 14.25 18C14.0511 18 13.8603 17.921 13.7197 17.7803C13.579 17.6397 13.5 17.4489 13.5 17.25V9.75C13.5 9.55109 13.579 9.36032 13.7197 9.21967C13.8603 9.07902 14.0511 9 14.25 9ZM6.734 18.467C6.78794 19.0236 7.04724 19.5403 7.46137 19.9161C7.87549 20.292 8.41475 20.5001 8.974 20.5H15.026C15.5853 20.5001 16.1245 20.292 16.5386 19.9161C16.9528 19.5403 17.2121 19.0236 17.266 18.467L18.424 6.5H5.576L6.734 18.467Z" fill="#C0C0C0"/>
                        </svg>                        
                      </a>
                    </div>                    
                  </td> 
                </tr>
                @end
              </tbody>
            </table>
          </div>

          <!--end: Datatable -->
        </div>
        <!--end::Notice-->
      </div>      
    </div>    
  </div>
</div>
<script>   
    $('.show_confirm').click(function(event) {
      var id = $(this).attr("data-id");        
      Swal.fire({
          html: `Are You sure to delete this Data?`,
          icon: "warning",
          buttonsStyling: false,
          showCancelButton: true,
          confirmButtonText: "Ok,",
          cancelButtonText: 'Nope, cancel it',
          customClass: {
              confirmButton: "btn btn-primary",
              cancelButton: 'btn btn-danger'
          }          
      }).then((result) => {
        if (result.isConfirmed) {       
          $.ajax({
            url: '/deleteSchema/' + id,
            type: "GET",
            success: function(response) { 
              window.location.reload();
            }                       
            });
            
        } 
      })
      
      
    })
    
    $(document).ready(function () {
        var t = $('#example').DataTable({
            ordering: false,					
        });

        $('#search').on( 'keyup', function () {
        t.search( this.value ).draw();
        });

        t.on('order.dt search.dt', function () {
            let i = 1;
    
            t.cells(null, 0, { search: 'applied', order: 'applied' }).every(function (cell) {
                this.data(i++);
            });
        }).draw();
    });
    
</script>

@end
